{% extends 'tickets/base.html' %}

{% block title %}تقديم طلب جديد - نظام إدارة الطلبات{% endblock %}

{% block content %}
<div class="row">
    <!-- Statistics Section -->
    <div class="col-md-12">
        <div class="page-header text-center">
            <h1><i class="bi bi-ticket-detailed"></i> نظام إدارة طلبات الحاسبة الإلكترونية</h1>
            <p class="lead text-muted">جامعة الكنوز - قسم الحاسبة الإلكترونية</p>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="col-md-4 mb-4">
        <div class="stats-card text-center">
            <i class="bi bi-inbox-fill" style="font-size: 2rem;"></i>
            <h3>{{ total_tickets }}</h3>
            <p class="mb-0">إجمالي الطلبات</p>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="stats-card text-center" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <i class="bi bi-clock-history" style="font-size: 2rem;"></i>
            <h3>{{ pending_tickets }}</h3>
            <p class="mb-0">قيد المراجعة</p>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="stats-card text-center" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <i class="bi bi-check-circle-fill" style="font-size: 2rem;"></i>
            <h3>{{ resolved_tickets }}</h3>
            <p class="mb-0">تم حلها</p>
        </div>
    </div>
</div>

<!-- Ticket Submission Form -->
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body p-4">
                <h2 class="card-title text-center mb-4">
                    <i class="bi bi-file-earmark-plus"></i>
                    تقديم طلب جديد
                </h2>

                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.full_name.id_for_label }}" class="form-label">
                                <i class="bi bi-person"></i> {{ form.full_name.label }}
                            </label>
                            {{ form.full_name }}
                            {% if form.full_name.errors %}
                            <div class="text-danger small mt-1">{{ form.full_name.errors.0 }}</div>
                            {% endif %}
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="{{ form.email.id_for_label }}" class="form-label">
                                <i class="bi bi-envelope"></i> {{ form.email.label }}
                            </label>
                            {{ form.email }}
                            {% if form.email.errors %}
                            <div class="text-danger small mt-1">{{ form.email.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.department.id_for_label }}" class="form-label">
                                <i class="bi bi-building"></i> {{ form.department.label }}
                            </label>
                            {{ form.department }}
                            {% if form.department.errors %}
                            <div class="text-danger small mt-1">{{ form.department.errors.0 }}</div>
                            {% endif %}
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="{{ form.request_type.id_for_label }}" class="form-label">
                                <i class="bi bi-tag"></i> {{ form.request_type.label }}
                            </label>
                            {{ form.request_type }}
                            {% if form.request_type.errors %}
                            <div class="text-danger small mt-1">{{ form.request_type.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.description.id_for_label }}" class="form-label">
                            <i class="bi bi-card-text"></i> {{ form.description.label }}
                        </label>
                        {{ form.description }}
                        {% if form.description.errors %}
                        <div class="text-danger small mt-1">{{ form.description.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.priority.id_for_label }}" class="form-label">
                                <i class="bi bi-exclamation-diamond"></i> {{ form.priority.label }}
                            </label>
                            {{ form.priority }}
                            {% if form.priority.errors %}
                            <div class="text-danger small mt-1">{{ form.priority.errors.0 }}</div>
                            {% endif %}
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="{{ form.attachment.id_for_label }}" class="form-label">
                                <i class="bi bi-paperclip"></i> {{ form.attachment.label }}
                            </label>
                            {{ form.attachment }}
                            {% if form.attachment.help_text %}
                            <div class="form-text">{{ form.attachment.help_text }}</div>
                            {% endif %}
                            {% if form.attachment.errors %}
                            <div class="text-danger small mt-1">{{ form.attachment.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-send-fill"></i>
                            إرسال الطلب
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="text-center mt-3">
            <a href="{% url 'tickets:ticket_list' %}" class="btn btn-outline-light">
                <i class="bi bi-list-ul"></i>
                عرض جميع الطلبات
            </a>
        </div>
    </div>
</div>
{% endblock %}